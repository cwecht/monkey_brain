<?xml version="1.0"?>
<!--
 we test that 'optimally enabled set' really is a set, specifically that if a transition is optimally enabled in
two different states, it is taken only once.  
-->
<scxml initial="s0" version="1.0">
  <state id="s0" initial="p0">
    <!--
 this transition should never be taken because a transition in a lower state should
  always be selected 
-->
    <transition event="event1">
       <script>val1 := val1 + 1</script>
    </transition>
    <parallel id="p0">
      <onentry>
        <raise event="event1"/>
        <raise event="event2"/>
      </onentry>
      <!--
 this transition will be selected by both states p0s1 and p0s2, but should be executed only once 
-->
      <transition event="event1">
       <script>val1 := val1 + 1</script>
      </transition>
      <state id="p0s1">
        <transition event="event2" cond="val1 == 1" target="conf:pass"/>
        <transition event="event2" target="conf:fail"/>
      </state>
      <state id="p0s2"/>
    </parallel>
  </state>
  <state id="conf:pass"/>
  <state id="conf:fail"/>
</scxml>
